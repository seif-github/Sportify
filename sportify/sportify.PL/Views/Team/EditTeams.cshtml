@model sportify.PL.ViewModels.LeagueDetailsViewModel

<div class="container">
    <h1 class="mb-4">Edit Teams for @Model.League.Name</h1>

    <!-- List of Teams -->
    <div class="card mb-4">
        <div class="card-header">
            <h5>Teams</h5>
        </div>
        <ul class="list-group list-group-flush">
            @foreach (var team in Model.Teams)
            {
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <div class="team-name" data-team-id="@team.TeamID">@team.Name</div>
                    <div>
                        <button type="button" class="btn btn-sm btn-outline-primary edit-btn"
                                onclick="editTeam(@team.TeamID, '@team.Name')">
                            Edit
                        </button>
                        <form method="post" action="@Url.Action("DeleteTeam")" class="d-inline">
                            @Html.AntiForgeryToken()
                            <input type="hidden" name="teamId" value="@team.TeamID" />
                            <input type="hidden" name="leagueId" value="@Model.League.LeagueID" />
                            <button type="submit" class="btn btn-sm btn-outline-danger"
                                    onclick="return confirm('Are you sure you want to delete this team?')">
                                Delete
                            </button>
                        </form>
                    </div>
                </li>
            }
        </ul>
    </div>

    <!-- Edit Team Form (Hidden by default) -->
    <div id="editForm" class="card mb-4" style="display: none;">
        <div class="card-header">
            <h5>Edit Team</h5>
        </div>
        <div class="card-body">
            <form method="post" action="@Url.Action("EditTeams")">
                @Html.AntiForgeryToken()
                <input type="hidden" name="League.LeagueID" value="@Model.League.LeagueID" />
                <input type="hidden" id="editTeamId" name="Teams[0].TeamID" value="" />
                <input type="hidden" name="Teams[0].LeagueID" value="@Model.League.LeagueID" />

                <div class="form-group">
                    <label for="editTeamName">Team Name</label>
                    <input type="text" class="form-control" id="editTeamName" name="Teams[0].Name" required />
                </div>

                <div class="mt-3">
                    <button type="submit" class="btn btn-primary">Save</button>
                    <button type="button" class="btn btn-secondary" onclick="cancelEdit()">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Team Form -->
    <div class="card mb-4">
        <div class="card-header">
            <h5>Add New Team</h5>
        </div>
        <div class="card-body">
            <form method="post" action="@Url.Action("AddTeam")">
                @Html.AntiForgeryToken()
                <input type="hidden" name="leagueId" value="@Model.League.LeagueID" />

                <div class="form-group">
                    <label for="teamName">Team Name</label>
                    <input type="text" class="form-control" id="teamName" name="teamName" required />
                </div>

                <div class="mt-3">
                    <button type="submit" class="btn btn-success">Add Team</button>
                </div>
            </form>
        </div>
    </div>

    <div class="mb-4">
        <a asp-action="Details" asp-controller="League" asp-route-id="@Model.League.LeagueID" class="btn btn-secondary">
            Back to League
        </a>
    </div>
</div>

@section Scripts {
    <script>
        function editTeam(teamId, teamName) {
            // Set form values
            document.getElementById('editTeamId').value = teamId;
            document.getElementById('editTeamName').value = teamName;

            // Show edit form
            document.getElementById('editForm').style.display = 'block';

            // Scroll to the form
            document.getElementById('editForm').scrollIntoView({ behavior: 'smooth' });

            // Focus on the input
            document.getElementById('editTeamName').focus();
        }

        function cancelEdit() {
            // Hide edit form
            document.getElementById('editForm').style.display = 'none';
        }
    </script>
}